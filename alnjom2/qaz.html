<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ù…Ø­Ø§ÙƒØ§Ø© Ù…ØªØ·ÙˆØ±Ø© Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„ØºØ§Ø²Ø§Øª - Web 3D</title>
<style>
  :root{
    --panel-bg: rgba(10,10,15,0.85);
    --accent: #4fc3ff;
    --accent2: #9b59ff;
    --text: #e6f7ff;
    --danger: #ff4d6d;
    --success: #2ecc71;
  }
  html,body{height:100%;margin:0;background:#000; font-family:Arial, "Noto Naskh Arabic", sans-serif; color:var(--text); overflow: hidden;}
  
  /* ØªØµÙ…ÙŠÙ… Ø¬Ø¯ÙŠØ¯ Ù„Ù„ØªØ®Ø·ÙŠØ· */
  .main-container {
    display: flex;
    height: 100vh;
    width: 100%;
  }
  
  /* Ù‚Ø³Ù… Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© (Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙŠØ³Ø±) */
  .simulation-section {
    flex: 1;
    position: relative;
    overflow: hidden;
  }
  
  /* Ù‚Ø³Ù… Ø§Ù„ØªØ­ÙƒÙ… (Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙŠÙ…Ù†) */
  .control-section {
    width: 360px;
    background: var(--panel-bg);
    border-left: 1px solid rgba(255,255,255,0.05);
    display: flex;
    flex-direction: column;
    overflow-y: auto;
  }
  
  #container{width:100%;height:100%;display:block;position:relative;overflow:hidden}
  canvas{display:block}

  /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ­ÙƒÙ… */
  .ui {
    padding: 16px;
    flex: 1;
  }
  .ui h2{margin:0 0 12px 0;font-size:18px;text-align:center;color:var(--accent)}
  .row{display:flex;gap:8px;align-items:center;margin:10px 0}
  .col{display:flex;flex-direction:column;gap:6px}
  .btn{
    background:linear-gradient(180deg,var(--accent),var(--accent2));
    border:none;color:#001;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700;
    box-shadow:0 4px 14px rgba(75,150,255,0.15);
    transition: all 0.2s ease;
    flex: 1;
    text-align: center;
  }
  .btn:hover{transform: translateY(-2px); box-shadow:0 6px 18px rgba(75,150,255,0.25);}
  .btn.secondary{background:#333;color:var(--text);box-shadow:none;border:1px solid rgba(255,255,255,0.06)}
  .btn.danger{background:var(--danger);color:white}
  .btn.success{background:var(--success);color:white}
  .slider{width:100%;cursor:pointer}
  label{font-size:13px;opacity:0.9;margin-bottom:4px}
  .gauge {
    height:120px; display:flex;align-items:center;gap:8px;
  }
  .gauge .bar {
    width:36px;height:100%;background:linear-gradient(#0d2,#045);border-radius:8px;position:relative;overflow:hidden;
  }
  .thermo {
    width:18px;height:100px;background:#111;border-radius:9px;position:relative;overflow:hidden;border:1px solid rgba(255,255,255,0.06)
  }
  .thermo .fill {position:absolute;left:0;bottom:0;width:100%;background:linear-gradient(#ff7b7b,#ff2e2e);transition:height .2s}
  .small {font-size:12px;color:#cfeeff}

  /* Ø¹Ø¯Ù‘Ø§Ø¯ Ø§Ù„Ø¶ØºØ· Ø±Ù‚Ù…ÙŠ */
  .pressure-box {margin-left:auto;background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:8px;font-weight:700}

  /* bottom controls */
  .bottom-controls {position:absolute;left:18px;bottom:18px;background:var(--panel-bg);padding:10px;border-radius:10px;display:flex;gap:8px;align-items:center}
  .stat {font-size:13px;padding:6px 10px;border-radius:8px;background:rgba(255,255,255,0.02)}

  /* Ù…Ø¶Ø®Ø© Ø§Ù„ØºØ§Ø² */
  .gas-pump {
    position: absolute;
    left: 20px;
    top: 20px;
    width: 180px;
    background: var(--panel-bg);
    border-radius: 12px;
    padding: 12px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.6);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255,255,255,0.05);
  }
  .pump-visual {
    width: 100%;
    height: 120px;
    background: linear-gradient(to bottom, #1a1a2e, #16213e);
    border-radius: 8px;
    position: relative;
    overflow: hidden;
    margin-bottom: 10px;
    border: 1px solid rgba(255,255,255,0.05);
  }
  .pump-cylinder {
    position: absolute;
    width: 60px;
    height: 80px;
    background: rgba(30,30,50,0.7);
    border-radius: 4px;
    left: 50%;
    top: 20px;
    transform: translateX(-50%);
    border: 1px solid rgba(255,255,255,0.1);
  }
  .pump-piston {
    position: absolute;
    width: 56px;
    height: 12px;
    background: #4a4a6a;
    border-radius: 2px;
    left: 50%;
    transform: translateX(-50%);
    transition: top 0.5s ease;
    border: 1px solid rgba(255,255,255,0.1);
  }
  .pump-valve {
    position: absolute;
    width: 20px;
    height: 8px;
    background: #666;
    border-radius: 2px;
    left: 50%;
    transform: translateX(-50%);
  }
  .valve-in { top: 10px; }
  .valve-out { bottom: 10px; }
  .pump-label {
    text-align: center;
    font-size: 12px;
    margin-top: 6px;
    opacity: 0.8;
  }

  /* Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØºØ§Ø² */
  .gas-info {
    position: absolute;
    right: 20px;
    bottom: 80px;
    background: var(--panel-bg);
    border-radius: 12px;
    padding: 12px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.6);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255,255,255,0.05);
    width: 200px;
  }
  .gas-type-selector {
    display: flex;
    gap: 6px;
    margin-bottom: 10px;
  }
  .gas-type-btn {
    flex: 1;
    padding: 6px;
    background: #222;
    border: none;
    border-radius: 6px;
    color: var(--text);
    cursor: pointer;
    font-size: 11px;
    text-align: center;
  }
  .gas-type-btn.active {
    background: var(--accent);
    color: #000;
    font-weight: bold;
  }
  .gas-property {
    display: flex;
    justify-content: space-between;
    margin: 6px 0;
    font-size: 12px;
  }
  .gas-property .value {
    font-weight: bold;
    color: var(--accent);
  }

  /* responsive small screens */
  @media (max-width:900px){
    .main-container {
      flex-direction: column;
    }
    .control-section {
      width: 100%;
      height: 40vh;
      border-left: none;
      border-top: 1px solid rgba(255,255,255,0.05);
    }
    .simulation-section {
      height: 60vh;
    }
    .gas-pump, .gas-info {
      display: none;
    }
  }

  /* ØªØ¨ÙˆÙŠØ¨Ø§Øª */
  .tabs {
    display: flex;
    margin-bottom: 12px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  .tab {
    padding: 8px 12px;
    cursor: pointer;
    font-size: 13px;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
  }
  .tab.active {
    border-bottom: 2px solid var(--accent);
    color: var(--accent);
  }

  /* Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
  .tab-content {
    display: none;
  }
  .tab-content.active {
    display: block;
  }

  /* Ø´Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø© */
  .status-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 8px;
    border-radius: 20px;
    font-size: 11px;
    background: rgba(255,255,255,0.05);
    margin-left: 8px;
  }
  .status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--success);
  }
  .status-dot.paused {
    background: #ffa500;
  }

  /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ© */
  .particle-count {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 48px;
    font-weight: bold;
    color: rgba(255,255,255,0.05);
    pointer-events: none;
    z-index: -1;
  }
</style>
</head>
<body>
<div class="main-container">
  <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© (Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙŠØ³Ø±) -->
  <div class="simulation-section">
    <div id="container"></div>
    
    <!-- Ù…Ø¶Ø®Ø© Ø§Ù„ØºØ§Ø² -->
    <div class="gas-pump">
      <h3 style="margin:0 0 10px 0;text-align:center;font-size:16px">Ù…Ø¶Ø®Ø© Ø§Ù„ØºØ§Ø²</h3>
      <div class="pump-visual">
        <div class="pump-cylinder">
          <div class="pump-piston" id="piston" style="top: 40px"></div>
        </div>
        <div class="pump-valve valve-in"></div>
        <div class="pump-valve valve-out"></div>
      </div>
      <div class="pump-label" id="pumpStatus">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¶Ø®Ø©: Ù…ØªÙˆÙ‚ÙØ©</div>
      <div class="row">
        <button class="btn success" id="pumpInBtn">Ø¶Ø® Ù„Ù„Ø¯Ø§Ø®Ù„</button>
        <button class="btn danger" id="pumpOutBtn">Ø¶Ø® Ù„Ù„Ø®Ø§Ø±Ø¬</button>
      </div>
    </div>

    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØºØ§Ø² -->
    <div class="gas-info">
      <h3 style="margin:0 0 10px 0;text-align:center;font-size:16px">Ø®ØµØ§Ø¦Øµ Ø§Ù„ØºØ§Ø²</h3>
      <div class="gas-type-selector">
        <button class="gas-type-btn active" data-gas="air">Ù‡ÙˆØ§Ø¡</button>
        <button class="gas-type-btn" data-gas="helium">Ù‡ÙŠÙ„ÙŠÙˆÙ…</button>
        <button class="gas-type-btn" data-gas="oxygen">Ø£ÙƒØ³Ø¬ÙŠÙ†</button>
        <button class="gas-type-btn" data-gas="co2">Ø«Ø§Ù†ÙŠ Ø£ÙƒØ³ÙŠØ¯ Ø§Ù„ÙƒØ±Ø¨ÙˆÙ†</button>
      </div>
      <div class="gas-property">
        <span>Ø§Ù„ÙƒØªÙ„Ø© Ø§Ù„Ù…ÙˆÙ„ÙŠØ©:</span>
        <span class="value" id="molarMass">28.97 g/mol</span>
      </div>
      <div class="gas-property">
        <span>Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†ÙˆØ¹ÙŠØ©:</span>
        <span class="value" id="specificHeat">1.005 J/gÂ·K</span>
      </div>
      <div class="gas-property">
        <span>Ø§Ù„Ù„Ø²ÙˆØ¬Ø©:</span>
        <span class="value" id="viscosity">18.6 Î¼PaÂ·s</span>
      </div>
      <div class="gas-property">
        <span>Ø¯Ø±Ø¬Ø© Ø§Ù„ØºÙ„ÙŠØ§Ù†:</span>
        <span class="value" id="boilingPoint">-194Â°C</span>
      </div>
    </div>

    <!-- Ø£Ø³ÙÙ„: Ø¥Ø­ØµØ§Ø¡Ø§Øª -->
    <div class="bottom-controls">
      <div class="stat">FPS: <span id="fps">0</span></div>
      <div class="stat">Ù…ØªÙˆØ³Ø· Ø³Ø±Ø¹Ø©: <span id="avgV">0</span> m/s</div>
      <div class="stat">Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ø­Ø±ÙƒÙŠØ©: <span id="kineticEnergy">0</span> J</div>
      <div class="stat">Ø§Ù„ØªØµØ§Ø¯Ù…Ø§Øª: <span id="totColl">0</span></div>
    </div>
  </div>

  <!-- Ù‚Ø³Ù… Ø§Ù„ØªØ­ÙƒÙ… (Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙŠÙ…Ù†) -->
  <div class="control-section">
    <div class="ui" id="ui">
      <h2>Ù…Ø­Ø§ÙƒØ§Ø© Ù…ØªØ·ÙˆØ±Ø© Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„ØºØ§Ø²Ø§Øª</h2>
      
      <div class="tabs">
        <div class="tab active" data-tab="control">Ø§Ù„ØªØ­ÙƒÙ…</div>
        <div class="tab" data-tab="visuals">Ø§Ù„Ù…Ø¸Ù‡Ø±</div>
        <div class="tab" data-tab="info">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</div>
      </div>

      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªØ­ÙƒÙ… -->
      <div class="tab-content active" id="control-tab">
        <div class="row">
          <div class="col" style="flex:1">
            <label>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© (K) <span class="status-badge"><span class="status-dot" id="tempStatus"></span> <span id="tempStatusText">Ù…ØªÙˆØ³Ø·Ø©</span></span></label>
            <input id="tempSlider" class="slider" type="range" min="50" max="800" step="10" value="300">
            <div class="small">Ø§Ù„Ø­Ø±Ø§Ø±Ø©: <span id="tempVal">300</span> K</div>
          </div>
          <div style="width:12px"></div>
          <div style="display:flex;flex-direction:column;gap:6px">
            <button class="btn success" id="heatBtn">ØªØ³Ø®ÙŠÙ† â†‘</button>
            <button class="btn" id="coolBtn">ØªØ¨Ø±ÙŠØ¯ â†“</button>
          </div>
        </div>

        <div class="row">
          <div class="col" style="flex:1">
            <label>Ø§Ù„Ø¶ØºØ· (Ù…Ø¶Ø®Ø©/Ø­Ø¬Ù…)</label>
            <input id="pumpSlider" class="slider" type="range" min="0.3" max="1.5" step="0.05" value="1">
            <div class="small">Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¬Ù…: <span id="volVal">100%</span></div>
          </div>
          <div style="width:12px"></div>
          <div style="display:flex;flex-direction:column;gap:6px">
            <button class="btn" id="addBtn">Ø¥Ø¶Ø§ÙØ© Ø¬Ø²ÙŠØ¦Ø§Øª +</button>
            <button class="btn secondary" id="removeBtn">Ø¥Ø²Ø§Ù„Ø© Ø¬Ø²ÙŠØ¦Ø§Øª -</button>
          </div>
        </div>

        <div class="row gauge">
          <div style="flex:1">
            <label>Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„Ø­Ø±Ø§Ø±Ø© (K)</label>
            <div class="thermo" style="height:100px">
              <div class="fill" id="thermoFill" style="height:40%"></div>
            </div>
          </div>
          <div style="width:8px"></div>
          <div style="display:flex;flex-direction:column;align-items:flex-end">
            <label>Ø§Ù„Ø¶ØºØ· (ØªÙ‚Ø±ÙŠØ¨ÙŠ)</label>
            <div class="pressure-box" id="pressureBox">1.00 atm</div>
            <div class="small" style="margin-top:8px">ØªØµØ§Ø¯Ù…Ø§Øª/Ø«: <span id="collPerSec">0</span></div>
          </div>
        </div>

        <div class="row" style="justify-content:center;margin-top:6px">
          <button class="btn success" id="startBtn">ØªØ´ØºÙŠÙ„ <span class="status-badge"><span class="status-dot"></span> Ù†Ø´Ø·</span></button>
          <button class="btn secondary" id="pauseBtn">Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª</button>
          <button class="btn danger" id="resetBtn">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
        </div>
      </div>

      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø¸Ù‡Ø± -->
      <div class="tab-content" id="visuals-tab">
        <div class="row">
          <div class="col">
            <label>Ù†Ù…Ø· Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª</label>
            <div style="display:flex;gap:6px">
              <button class="btn secondary active" data-style="spheres">ÙƒØ±Ø§Øª</button>
              <button class="btn secondary" data-style="cubes">Ù…ÙƒØ¹Ø¨Ø§Øª</button>
              <button class="btn secondary" data-style="dots">Ù†Ù‚Ø§Ø·</button>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <label>Ù„ÙˆÙ† Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø­Ø³Ø¨</label>
            <div style="display:flex;gap:6px;flex-wrap:wrap">
              <button class="btn secondary active" data-color="speed">Ø§Ù„Ø³Ø±Ø¹Ø©</button>
              <button class="btn secondary" data-color="energy">Ø§Ù„Ø·Ø§Ù‚Ø©</button>
              <button class="btn secondary" data-color="temperature">Ø§Ù„Ø­Ø±Ø§Ø±Ø©</button>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <label>Ù…Ø³Ø§Ø± Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª</label>
            <div style="display:flex;gap:6px">
              <button class="btn secondary" id="trailsOn">ØªØ´ØºÙŠÙ„</button>
              <button class="btn secondary active" id="trailsOff">Ø¥ÙŠÙ‚Ø§Ù</button>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <label>Ø´Ø¯Ø© Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø©</label>
            <input id="lightSlider" class="slider" type="range" min="0.1" max="2" step="0.1" value="1">
          </div>
        </div>
      </div>

      <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª -->
      <div class="tab-content" id="info-tab">
        <div style="font-size:13px;line-height:1.6">
          <p>Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© ØªÙˆØ¶Ø­ Ø³Ù„ÙˆÙƒ Ø§Ù„ØºØ§Ø²Ø§Øª ÙˆÙÙ‚Ù‹Ø§ Ù„Ù„Ù†Ø¸Ø±ÙŠØ© Ø§Ù„Ø­Ø±ÙƒÙŠØ© Ù„Ù„ØºØ§Ø²Ø§Øª:</p>
          <ul style="padding-right:15px">
            <li>ØªØªØ­Ø±Ùƒ Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ ÙˆÙ…Ø³ØªÙ…Ø±</li>
            <li>ØªØªØµØ§Ø¯Ù… Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ù…Ø¹ Ø¨Ø¹Ø¶Ù‡Ø§ ÙˆÙ…Ø¹ Ø¬Ø¯Ø±Ø§Ù† Ø§Ù„ÙˆØ¹Ø§Ø¡</li>
            <li>Ø§Ù„Ø¶ØºØ· Ù†Ø§ØªØ¬ Ø¹Ù† ØªØµØ§Ø¯Ù… Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ù…Ø¹ Ø§Ù„Ø¬Ø¯Ø±Ø§Ù†</li>
            <li>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù…ØªÙˆØ³Ø· Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ø­Ø±ÙƒÙŠØ©</li>
          </ul>
          <p style="margin-top:12px;border-top:1px solid rgba(255,255,255,0.1);padding-top:8px">
            <strong>Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„ØºØ§Ø² Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ:</strong> PV = nRT<br>
            P: Ø§Ù„Ø¶ØºØ·, V: Ø§Ù„Ø­Ø¬Ù…, n: Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆÙ„Ø§Øª, R: Ø«Ø§Ø¨Øª Ø§Ù„ØºØ§Ø², T: Ø§Ù„Ø­Ø±Ø§Ø±Ø©
          </p>
          <p>
          
          # Ø´Ø±Ø­ Ù…Ø¨Ø³Ø· Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØºØ§Ø²Ø§Øª Ù„Ù„ØªÙ„Ø§Ù…ÙŠØ° ğŸŒŸ

## Ù…Ø§ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©ØŸ

ØªØ®ÙŠÙ„ Ø£Ù†Ùƒ ØªÙ†Ø¸Ø± Ø¥Ù„Ù‰ ØµÙ†Ø¯ÙˆÙ‚ Ù…Ù„ÙŠØ¡ Ø¨ÙƒØ±Ø§Øª ØµØºÙŠØ±Ø© ØªØªØ­Ø±Ùƒ Ø¨Ø³Ø±Ø¹Ø©! Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© ØªØ¸Ù‡Ø± Ù„Ù†Ø§ ÙƒÙŠÙ ØªØªØµØ±Ù Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„ØºØ§Ø² Ø¯Ø§Ø®Ù„ ÙˆØ¹Ø§Ø¡.

## Ù…Ø§Ø°Ø§ Ù†Ø±Ù‰ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©ØŸ

### ğŸ¯ **Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:**
- **Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª** (Ø§Ù„ÙƒØ±Ø§Øª Ø§Ù„Ù…Ù„ÙˆÙ†Ø©) - ØªØªØ­Ø±Ùƒ ÙÙŠ ÙƒÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª
- **Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø´ÙØ§Ù** - Ø§Ù„ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø§Ù„ØºØ§Ø²
- **Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„Ø­Ø±Ø§Ø±Ø©** - ÙŠØ¸Ù‡Ø± Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„ØºØ§Ø²
- **Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¶ØºØ·** - ÙŠØ¸Ù‡Ø± Ù‚ÙˆØ© Ø¶ØºØ· Ø§Ù„ØºØ§Ø²
- **Ø§Ù„Ù…Ø¶Ø®Ø©** - Ù„ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„ÙˆØ¹Ø§Ø¡

## Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« Ø¹Ù„Ù…ÙŠØ§Ù‹ØŸ ğŸ”¬

### 1. **Ù„Ù…Ø§Ø°Ø§ ØªØªØ­Ø±Ùƒ Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§ØªØŸ**
- Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª ÙÙŠ Ø­Ø§Ù„Ø© Ø­Ø±ÙƒØ© Ø¯Ø§Ø¦Ù…Ø©
- ÙƒÙ„Ù…Ø§ Ø²Ø§Ø¯Øª Ø§Ù„Ø­Ø±Ø§Ø±Ø© â†’ Ø²Ø§Ø¯Øª Ø³Ø±Ø¹ØªÙ‡Ø§
- Ù…Ø«Ù„ Ø¹Ù†Ø¯Ù…Ø§ ØªØ³Ø®Ù† Ø§Ù„Ù…Ø§Ø¡ â†’ ÙŠØªØ­ÙˆÙ„ Ø¥Ù„Ù‰ Ø¨Ø®Ø§Ø±

### 2. **Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¶ØºØ·ØŸ**
- Ø¹Ù†Ø¯Ù…Ø§ ØªØµØ·Ø¯Ù… Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø¨Ø¬Ø¯Ø±Ø§Ù† Ø§Ù„ÙˆØ¹Ø§Ø¡
- ÙƒÙ„Ù…Ø§ Ø²Ø§Ø¯Øª Ø§Ù„ØªØµØ§Ø¯Ù…Ø§Øª â†’ Ø²Ø§Ø¯ Ø§Ù„Ø¶ØºØ·
- Ù…Ø«Ù„ Ø¹Ù†Ø¯Ù…Ø§ ØªÙ†ÙØ® Ø¨Ø§Ù„ÙˆÙ† â†’ ÙŠØµØ¨Ø­ ØµÙ„Ø¨Ø§Ù‹

### 3. **ÙƒÙŠÙ ØªØ¤Ø«Ø± Ø§Ù„Ø­Ø±Ø§Ø±Ø©ØŸ**
- ğŸ”¥ **ØªØ³Ø®ÙŠÙ†** â†’ Ø¬Ø²ÙŠØ¦Ø§Øª Ø£Ø³Ø±Ø¹ â†’ Ø¶ØºØ· Ø£Ø¹Ù„Ù‰
- â„ï¸ **ØªØ¨Ø±ÙŠØ¯** â†’ Ø¬Ø²ÙŠØ¦Ø§Øª Ø£Ø¨Ø·Ø£ â†’ Ø¶ØºØ· Ø£Ù‚Ù„

## Ø¬Ø±Ø¨ Ø¨Ù†ÙØ³Ùƒ! ğŸ®

### âœ¨ **ØªØ¬Ø±Ø¨Ø© 1: Ø§Ù„ØªØ³Ø®ÙŠÙ†**
1. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± **"ØªØ³Ø®ÙŠÙ† â†‘"**
2. Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª ØªØªØ­Ø±Ùƒ **Ø£Ø³Ø±Ø¹**
3. Ù„Ø§Ø­Ø¸ Ø§Ø±ØªÙØ§Ø¹ **Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„Ø­Ø±Ø§Ø±Ø©**
4. Ø´Ø§Ù‡Ø¯ Ø²ÙŠØ§Ø¯Ø© **Ø§Ù„Ø¶ØºØ·**

### âœ¨ **ØªØ¬Ø±Ø¨Ø© 2: Ø§Ù„Ù…Ø¶Ø®Ø©**
1. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ **"Ø¶Ø® Ù„Ù„Ø¯Ø§Ø®Ù„"**
2. Ø´Ø§Ù‡Ø¯ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ **ÙŠØµØºØ±**
3. Ù„Ø§Ø­Ø¸ Ø²ÙŠØ§Ø¯Ø© **Ø§Ù„Ø¶ØºØ·** ÙÙˆØ±Ø§Ù‹
4. Ø§Ù„Ø³Ø¨Ø¨: Ù†ÙØ³ Ø§Ù„Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª ÙÙŠ Ù…Ø³Ø§Ø­Ø© Ø£ØµØºØ±

### âœ¨ **ØªØ¬Ø±Ø¨Ø© 3: Ø¥Ø¶Ø§ÙØ© Ø¬Ø²ÙŠØ¦Ø§Øª**
1. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ **"Ø¥Ø¶Ø§ÙØ© Ø¬Ø²ÙŠØ¦Ø§Øª +"**
2. Ø´Ø§Ù‡Ø¯ Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª
3. Ù„Ø§Ø­Ø¸ Ø²ÙŠØ§Ø¯Ø© **Ø§Ù„Ø¶ØºØ·**
4. Ø§Ù„Ø³Ø¨Ø¨: Ø¬Ø²ÙŠØ¦Ø§Øª Ø£ÙƒØ«Ø± = ØªØµØ§Ø¯Ù…Ø§Øª Ø£ÙƒØ«Ø±

## Ø£Ø´ÙŠØ§Ø¡ Ù…Ø³Ù„ÙŠØ© ÙŠÙ…ÙƒÙ† Ù…Ù„Ø§Ø­Ø¸ØªÙ‡Ø§ ğŸª

1. **Ø§Ù„Ø£Ù„ÙˆØ§Ù† ØªØªØºÙŠØ±** - Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø© Ø­Ù…Ø±Ø§Ø¡ØŒ Ø§Ù„Ø¨Ø·ÙŠØ¦Ø© Ø²Ø±Ù‚Ø§Ø¡
2. **Ø§Ù„Ø·Ø§Ù‚Ø© ØªÙ†ØªÙ‚Ù„** - Ø¹Ù†Ø¯Ù…Ø§ ØªØªØµØ§Ø¯Ù… Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§ØªØŒ ØªØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ø·Ø§Ù‚Ø©
3. **Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©** - Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ù…Ø· Ø«Ø§Ø¨Øª Ù„Ù„Ø­Ø±ÙƒØ©

## Ø£Ø´ÙŠØ§Ø¡ Ø­Ù‚ÙŠÙ‚ÙŠØ© ØªØ´Ø¨Ù‡ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© ğŸ—ï¸

1. **Ø§Ù„Ø·Ø§Ø¦Ø±Ø§Øª** - Ø¶ØºØ· Ø§Ù„Ù‡ÙˆØ§Ø¡ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù‚ØµÙˆØ±Ø©
2. **Ø§Ù„Ø«Ù„Ø§Ø¬Ø©** - ØªØ¨Ø±ÙŠØ¯ Ø§Ù„ØºØ§Ø² Ù„ÙŠØµØ¨Ø­ Ø³Ø§Ø¦Ù„Ø§Ù‹
3. **Ø¥Ø·Ø§Ø±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø©** - Ø§Ù„Ù‡ÙˆØ§Ø¡ Ø§Ù„Ù…Ø¶ØºÙˆØ· ÙŠØ­Ù…Ù„ Ø§Ù„ÙˆØ²Ù†
4. **Ø§Ù„Ø¨Ø§Ù„ÙˆÙ†** - Ø¹Ù†Ø¯Ù…Ø§ ØªÙ†ÙØ®Ù‡ ÙŠÙ…ØªÙ„Ø¦ Ø¨Ø§Ù„Ù‡ÙˆØ§Ø¡ Ø§Ù„Ù…Ø¶ØºÙˆØ·

## Ø£Ø³Ø¦Ù„Ø© Ù„Ù„ØªÙÙƒÙŠØ± ğŸ¤”

1. Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« Ù„Ùˆ Ø£ÙˆÙ‚ÙÙ†Ø§ Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø¹Ù† Ø§Ù„Ø­Ø±ÙƒØ©ØŸ
2. Ù„Ù…Ø§Ø°Ø§ ÙŠÙ†ØªÙØ® Ø§Ù„Ø¨Ø§Ù„ÙˆÙ† ÙÙŠ ÙŠÙˆÙ… Ø­Ø§Ø±ØŸ
3. ÙƒÙŠÙ ØªØ¹Ù…Ù„ Ø§Ù„Ù…Ø¶Ø®Ø© ÙÙŠ Ø¯Ø±Ø§Ø¬ØªÙƒ Ø§Ù„Ù‡ÙˆØ§Ø¦ÙŠØ©ØŸ

## Ø§Ù„Ø®Ù„Ø§ØµØ© ğŸ“š

Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© ØªØ´Ø±Ø­ Ø«Ù„Ø§Ø« Ù‚ÙˆØ§Ø¹Ø¯ Ù…Ù‡Ù…Ø©:

1. **Ø§Ù„Ø­Ø±Ø§Ø±Ø© ØªØ²ÙŠØ¯ Ø­Ø±ÙƒØ© Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª** ğŸ”¥
2. **ØªÙ‚Ù„Øµ Ø§Ù„Ø­Ø¬Ù… ÙŠØ²ÙŠØ¯ Ø§Ù„Ø¶ØºØ·** ğŸ“¦
3. **Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª ØªØ²ÙŠØ¯ Ø§Ù„Ø¶ØºØ·** ğŸ‘¥

Ø§Ù„Ø¢Ù† ÙŠÙ…ÙƒÙ†Ùƒ Ø£Ù† ØªÙƒÙˆÙ† Ø¹Ø§Ù„Ù… ØµØºÙŠØ± ÙˆØªØ¬Ø±Ø¨ ÙƒÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†ÙØ³Ùƒ! Ù…Ø§Ø°Ø§ Ø³ØªÙƒØªØ´ÙØŸ ğŸŒˆ

**Ø¬Ø±Ø¨ ÙˆØ´Ø§Ù‡Ø¯ Ø¨Ù†ÙØ³Ùƒ ÙƒÙŠÙ ØªØ¹ØªØ¨Ø± Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„ØºØ§Ø²Ø§Øª Ø­ÙˆÙ„Ù†Ø§ ÙÙŠ ÙƒÙ„ Ù…ÙƒØ§Ù†!** ğŸ‰
          
          </p>
        </div>
      </div>

      <div style="margin-top:10px;text-align:center;font-size:12px;opacity:0.9;border-top:1px solid rgba(255,255,255,0.1);padding-top:8px">
        Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª: <span id="countParticles">0</span> Â· Ø§Ù„Ø­Ø¬Ù…: <span id="boxSizeLabel">12.0</span> Â· Ø§Ù„ÙƒØªÙ„Ø© Ø§Ù„Ù…ÙˆÙ„ÙŠØ©: <span id="molarMassLabel">28.97</span> g/mol
      </div>
    </div>
  </div>
</div>

<!-- Three.js Ùˆ OrbitControls Ù…Ù† CDN -->
<script src="https://cdn.jsdelivr.net/npm/three@0.138.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.138.0/examples/js/controls/OrbitControls.js"></script>

<script>
/* ====== Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø´Ù‡Ø¯ (Three.js) ====== */
const container = document.getElementById('container');
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x05060a);

const camera = new THREE.PerspectiveCamera(60, container.clientWidth/container.clientHeight, 0.1, 1000);
camera.position.set(15, 8, 18);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(container.clientWidth, container.clientHeight);
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap;
container.appendChild(renderer.domElement);

// Ø¥Ø¶Ø§Ø¡Ø§Øª
const hemi = new THREE.HemisphereLight(0xb2e0ff, 0x202040, 0.7);
scene.add(hemi);
const pLight = new THREE.PointLight(0xffffff, 1.1, 100);
pLight.position.set(10, 15, 10);
pLight.castShadow = true;
pLight.shadow.mapSize.width = 2048;
pLight.shadow.mapSize.height = 2048;
scene.add(pLight);

// ØµÙ†Ø¯ÙˆÙ‚ Ø¹Ø±Ø¶ (Ø­Ø¯ÙˆØ¯) - Ù…Ø¬Ø±Ø¯ Ø®Ø·ÙˆØ· Ù…Ø³Ø§Ø¹Ø¯Ø©
let BOX_HALF = 6; // ÙˆÙŠØ­Ø¯Ø¯ Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ
const boxGeo = new THREE.BoxGeometry(BOX_HALF*2, BOX_HALF*2, BOX_HALF*2);
const edges = new THREE.EdgesGeometry(boxGeo);
const boxMat = new THREE.LineBasicMaterial({color:0x2f9eff, linewidth:1, opacity:0.15, transparent:true});
const boxWire = new THREE.LineSegments(edges, boxMat);
scene.add(boxWire);

// ÙƒØ§Ù…ÙŠØ±Ø§ ØªØ­ÙƒÙ…
const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.target.set(0,0,0);

/* ====== Ù…ÙƒØ§Ù† ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª ====== */
let particles = [];
let particleGroup = new THREE.Group();
scene.add(particleGroup);

/* Ø¶Ø¨Ø· Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¦ÙŠØ© */
let running = true;
let temperature = parseFloat(document.getElementById('tempSlider').value); // ÙŠØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø³Ø±Ø¹Ø©
let collisionCount = 0;
let collisionsThisSecond = 0;
let currentGasType = 'air';

// Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØºØ§Ø²Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
const gasProperties = {
  air: {
    name: 'Ù‡ÙˆØ§Ø¡',
    molarMass: 28.97,
    specificHeat: 1.005,
    viscosity: 18.6,
    boilingPoint: -194,
    color: 0x66aaff
  },
  helium: {
    name: 'Ù‡ÙŠÙ„ÙŠÙˆÙ…',
    molarMass: 4.0026,
    specificHeat: 5.193,
    viscosity: 19.9,
    boilingPoint: -269,
    color: 0xffcc00
  },
  oxygen: {
    name: 'Ø£ÙƒØ³Ø¬ÙŠÙ†',
    molarMass: 32.0,
    specificHeat: 0.918,
    viscosity: 20.8,
    boilingPoint: -183,
    color: 0xff6666
  },
  co2: {
    name: 'Ø«Ø§Ù†ÙŠ Ø£ÙƒØ³ÙŠØ¯ Ø§Ù„ÙƒØ±Ø¨ÙˆÙ†',
    molarMass: 44.01,
    specificHeat: 0.839,
    viscosity: 14.9,
    boilingPoint: -78.5,
    color: 0x88cc88
  }
};

/* Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª ÙˆØ§Ù„Ù…ÙˆØ§Ø¯ */
const sphereGeom = new THREE.SphereGeometry(0.25, 16, 12);
const cubeGeom = new THREE.BoxGeometry(0.4, 0.4, 0.4);
const dotGeom = new THREE.SphereGeometry(0.1, 8, 6);

const materials = {
  blue: new THREE.MeshStandardMaterial({color:0x66aaff, metalness:0.2, roughness:0.5}),
  hot: new THREE.MeshStandardMaterial({color:0xffb86b, emissive:0x3b1200, metalness:0.4, roughness:0.3}),
  helium: new THREE.MeshStandardMaterial({color:0xffcc00, metalness:0.3, roughness:0.4}),
  oxygen: new THREE.MeshStandardMaterial({color:0xff6666, metalness:0.2, roughness:0.5}),
  co2: new THREE.MeshStandardMaterial({color:0x88cc88, metalness:0.2, roughness:0.5})
};

/* Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø²ÙŠØ¡ */
function createParticle(x,y,z, vx, vy, vz) {
  const m = new THREE.Mesh(sphereGeom, materials.blue);
  m.position.set(x,y,z);
  m.userData = {
    v: new THREE.Vector3(vx,vy,vz),
    r: 0.25,
    originalColor: gasProperties[currentGasType].color
  };
  m.castShadow = true;
  particleGroup.add(m);
  particles.push(m);
  updateParticleColor(m);
}

/* ØªØ­Ø¯ÙŠØ« Ù„ÙˆÙ† Ø§Ù„Ø¬Ø²ÙŠØ¡ Ø­Ø³Ø¨ Ø§Ù„Ø³Ø±Ø¹Ø© */
function updateParticleColor(particle) {
  const speed = particle.userData.v.length();
  const maxSpeed = 5; // Ø£Ù‚ØµÙ‰ Ø³Ø±Ø¹Ø© Ù…ØªÙˆÙ‚Ø¹Ø©
  
  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø±Ø¹Ø© (Ù…Ù† Ø§Ù„Ø£Ø²Ø±Ù‚ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø­Ù…Ø±)
  const ratio = Math.min(speed / maxSpeed, 1);
  const color = new THREE.Color();
  
  if (ratio < 0.5) {
    color.r = 0;
    color.g = ratio * 2;
    color.b = 1 - ratio * 2;
  } else {
    color.r = (ratio - 0.5) * 2;
    color.g = 1 - (ratio - 0.5) * 2;
    color.b = 0;
  }
  
  particle.material.color = color;
}

/* ØªÙ‡ÙŠØ¦Ø© Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© */
function initParticles(n=180){
  // ØªÙ†Ø¸ÙŠÙ Ø£ÙˆÙ„
  for (let p of particles) particleGroup.remove(p);
  particles = [];
  const spread = BOX_HALF*1.6;
  for (let i=0;i<n;i++){
    const x = THREE.MathUtils.randFloatSpread(spread);
    const y = THREE.MathUtils.randFloatSpread(spread);
    const z = THREE.MathUtils.randFloatSpread(spread);
    const speed = THREE.MathUtils.randFloat(0.2,1.0) * (temperature/300);
    const phi = Math.random()*Math.PI*2;
    const cost = (Math.random()*2-1);
    const vx = speed*Math.cos(phi)*(1-cost);
    const vy = speed*Math.sin(phi)*(1+cost)/2;
    const vz = THREE.MathUtils.randFloatSpread(speed);
    createParticle(x,y,z,vx,vy,vz);
  }
  updateUICounts();
}

/* ====== ÙÙŠØ²ÙŠØ§Ø¡ (Ø¨Ø´ÙƒÙ„ Ù…Ø¨Ø³Ù‘Ø·) ====== */
/* ØªØ­Ø±ÙŠÙƒ ÙˆØ§ØµØ·Ø¯Ø§Ù… Ù…Ø¹ Ø¬Ø¯Ø±Ø§Ù† Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ + ØªØµØ§Ø¯Ù…Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª (ØªÙ‚Ø±ÙŠØ¨) */
function physicsStep(dt){
  const half = BOX_HALF * currentBoxScale;
  const min = -half;
  const max = half;
  
  // Ø£ÙˆÙ„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
  for (let p of particles){
    const v = p.userData.v;
    p.position.x += v.x * dt;
    p.position.y += v.y * dt;
    p.position.z += v.z * dt;

    // ØªØµØ§Ø¯Ù… Ø¨Ø§Ù„Ø¬Ø¯Ø±Ø§Ù† (Ø§Ù†Ø¹ÙƒØ§Ø³ Ù…Ø±Ù†)
    if (p.position.x - p.userData.r < min){
      p.position.x = min + p.userData.r;
      v.x *= -1;
      collisionCount++; collisionsThisSecond++;
    } else if (p.position.x + p.userData.r > max){
      p.position.x = max - p.userData.r;
      v.x *= -1;
      collisionCount++; collisionsThisSecond++;
    }
    if (p.position.y - p.userData.r < min){
      p.position.y = min + p.userData.r;
      v.y *= -1;
      collisionCount++; collisionsThisSecond++;
    } else if (p.position.y + p.userData.r > max){
      p.position.y = max - p.userData.r;
      v.y *= -1;
      collisionCount++; collisionsThisSecond++;
    }
    if (p.position.z - p.userData.r < min){
      p.position.z = min + p.userData.r;
      v.z *= -1;
      collisionCount++; collisionsThisSecond++;
    } else if (p.position.z + p.userData.r > max){
      p.position.z = max - p.userData.r;
      v.z *= -1;
      collisionCount++; collisionsThisSecond++;
    }
    
    // ØªØ­Ø¯ÙŠØ« Ù„ÙˆÙ† Ø§Ù„Ø¬Ø²ÙŠØ¡ Ø­Ø³Ø¨ Ø§Ù„Ø³Ø±Ø¹Ø©
    updateParticleColor(p);
  }

  // ØªØµØ§Ø¯Ù…Ø§Øª Ø¬Ø²ÙŠØ¡-Ø¬Ø²ÙŠØ¡ (Ù…Ø±Ù†) - ØªØ¨Ø³ÙŠØ·
  for (let i=0;i<particles.length;i++){
    const A = particles[i];
    for (let j=i+1;j<particles.length;j++){
      const B = particles[j];
      const dx = B.position.x - A.position.x;
      const dy = B.position.y - A.position.y;
      const dz = B.position.z - A.position.z;
      const dist2 = dx*dx + dy*dy + dz*dz;
      const rsum = A.userData.r + B.userData.r;
      if (dist2 < (rsum*rsum)){
        const dist = Math.sqrt(dist2) || 0.0001;
        // Ø§ÙØµÙ„ Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ù‚Ù„ÙŠÙ„Ø§Ù‹
        const overlap = (rsum - dist) / 2;
        const nx = dx / dist, ny = dy / dist, nz = dz / dist;
        A.position.x -= nx * overlap;
        A.position.y -= ny * overlap;
        A.position.z -= nz * overlap;
        B.position.x += nx * overlap;
        B.position.y += ny * overlap;
        B.position.z += nz * overlap;
        // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ (ØªØµØ§Ø¯Ù… Ù…Ø±Ù† ÙˆØ­ÙØ¸ Ø§Ù„Ø·Ø§Ù‚Ø©)
        const va = A.userData.v;
        const vb = B.userData.v;
        // Ø­Ø³Ø§Ø¨ Ù…ÙƒÙˆÙ†Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­ÙˆØ±
        const relA = va.x*nx + va.y*ny + va.z*nz;
        const relB = vb.x*nx + vb.y*ny + vb.z*nz;
        // ØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ø³Ø±Ø¹Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­ÙˆØ±
        const newRelA = relB;
        const newRelB = relA;
        // ÙØ±Ù‚
        const diffA = newRelA - relA;
        const diffB = newRelB - relB;
        va.x += diffA * nx; va.y += diffA * ny; va.z += diffA * nz;
        vb.x += diffB * nx; vb.y += diffB * ny; vb.z += diffB * nz;
      }
    }
  }
}

/* ====== Ù‚ÙŠØ§Ø³Ø§Øª: Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø±Ø¹Ø© -> Ø­Ø±Ø§Ø±Ø© ØªÙ‚Ø±ÙŠØ¨ÙŠØ© ØŒ ÙˆØ¶ØºØ· = ØªØµØ§Ø¯Ù…Ø§Øª/Ø«Ø§Ù†ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø¯Ø±Ø§Ù† ====== */
function computeStats(dt){
  // Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø±Ø¹Ø© ÙˆØ§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ø­Ø±ÙƒÙŠØ©
  let sumV = 0;
  let sumKE = 0;
  const molarMass = gasProperties[currentGasType].molarMass / 1000; // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ kg/mol
  const particleMass = molarMass / 6.022e23; // ÙƒØªÙ„Ø© Ø§Ù„Ø¬Ø²ÙŠØ¡ Ø§Ù„ÙˆØ§Ø­Ø¯
  
  for (let p of particles){
    const v = p.userData.v.length();
    sumV += v;
    sumKE += 0.5 * particleMass * v * v;
  }
  const avgV = particles.length > 0 ? sumV / particles.length : 0;
  const totalKE = sumKE;
  
  // Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„Ø­Ø±Ø§Ø±Ø©: Ø³Ù†Ø±Ø¨Ø·Ù‡ Ø¨Ø§Ù„Ù€ temperature input
  const tempEstimate = temperature; // Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø©

  // Ø¶ØºØ· ØªÙ‚Ø±ÙŠØ¨ÙŠ: Ù†Ø¹ØªØ¨Ø± Ø§Ù„ØªØµØ§Ø¯Ù…Ø§Øª Ù…Ø¹ Ø£ÙŠ Ø¬Ø¯Ø§Ø± ÙƒÙ…Ù‚ÙŠØ§Ø³ (normalize)
  // Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„ØºØ§Ø² Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ: PV = nRT
  const n = particles.length / 6.022e23; // Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆÙ„Ø§Øª
  const R = 8.314; // Ø«Ø§Ø¨Øª Ø§Ù„ØºØ§Ø² Ø§Ù„Ø¹Ø§Ù…
  const V = Math.pow(BOX_HALF * 2 * currentBoxScale, 3); // Ø§Ù„Ø­Ø¬Ù… Ø¨Ø§Ù„Ù…ØªØ± Ø§Ù„Ù…ÙƒØ¹Ø¨
  const pressurePa = n * R * temperature / V;
  const pressureAtm = (pressurePa / 101325).toFixed(2);

  return {avgV, tempEstimate, collisions: collisionsThisSecond, pressureAtm, totalKE};
}

/* ====== Ø­Ù„Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¶ ====== */
let last = performance.now();
let fpsCounter = {count:0,lastTime: performance.now()};
let currentBoxScale = 1.0;
function animate(now){
  requestAnimationFrame(animate);
  const dt = Math.min(0.05, (now - last)/1000); // seconds
  last = now;

  if (running){
    physicsStep(dt);
  }
  controls.update();
  renderer.render(scene, camera);

  // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø¥Ø­ØµØ§Ø¡Ø§Øª
  fpsCounter.count++;
  if (now - fpsCounter.lastTime > 500){
    const fps = Math.round((fpsCounter.count*1000)/(now - fpsCounter.lastTime));
    document.getElementById('fps').innerText = fps;
    fpsCounter.count = 0;
    fpsCounter.lastTime = now;
  }

  const stats = computeStats(dt);
  document.getElementById('avgV').innerText = stats.avgV.toFixed(2);
  
  // ØªØ­Ø¯ÙŠØ« Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„Ø­Ø±Ø§Ø±Ø© (Ù…Ù† 50K Ø¥Ù„Ù‰ 800K)
  const tempPercent = Math.min(100, Math.max(0, (temperature - 50) / (800 - 50) * 100));
  document.getElementById('thermoFill').style.height = tempPercent + '%';
  
  document.getElementById('tempVal').innerText = temperature.toFixed(0);
  document.getElementById('collPerSec').innerText = stats.collisions;
  document.getElementById('pressureBox').innerText = stats.pressureAtm + ' atm';
  document.getElementById('totColl').innerText = collisionCount;
  document.getElementById('kineticEnergy').innerText = stats.totalKE.toExponential(2);
  
  // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©
  const tempStatus = document.getElementById('tempStatus');
  const tempStatusText = document.getElementById('tempStatusText');
  if (temperature < 150) {
    tempStatus.style.background = '#4fc3ff';
    tempStatusText.textContent = 'Ø¨Ø§Ø±Ø¯';
  } else if (temperature < 450) {
    tempStatus.style.background = '#ffa500';
    tempStatusText.textContent = 'Ù…ØªÙˆØ³Ø·Ø©';
  } else {
    tempStatus.style.background = '#ff2e2e';
    tempStatusText.textContent = 'Ø³Ø§Ø®Ù†';
  }
}

/* Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø¯Ù‘ Ø§Ù„ØªØµØ§Ø¯Ù…Ø§Øª ÙƒÙ„ Ø«Ø§Ù†ÙŠØ© */
setInterval(()=>{ collisionsThisSecond = 0; }, 1000);

/* ====== Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… (UI) ====== */
document.getElementById('tempSlider').addEventListener('input',(e)=>{
  temperature = parseFloat(e.target.value);
  document.getElementById('tempVal').innerText = temperature.toFixed(0);
  // Ù†Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ø³Ø±Ø¹Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ø­ÙŠØ« ØªØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ø­Ø±Ø§Ø±Ø©
  const factor = Math.sqrt(temperature / 300); // Ø­Ø³Ø¨ Ø§Ù„Ù†Ø¸Ø±ÙŠØ© Ø§Ù„Ø­Ø±ÙƒÙŠØ©
  for (let p of particles){
    p.userData.v.multiplyScalar(factor);
  }
});

document.getElementById('heatBtn').addEventListener('click',()=>{
  temperature = Math.min(800, temperature + 50);
  document.getElementById('tempSlider').value = temperature;
  document.getElementById('tempVal').innerText = temperature.toFixed(0);
  const factor = Math.sqrt(temperature / (temperature - 50));
  for (let p of particles) p.userData.v.multiplyScalar(factor);
});
document.getElementById('coolBtn').addEventListener('click',()=>{
  temperature = Math.max(50, temperature - 50);
  document.getElementById('tempSlider').value = temperature;
  document.getElementById('tempVal').innerText = temperature.toFixed(0);
  const factor = Math.sqrt(temperature / (temperature + 50));
  for (let p of particles) p.userData.v.multiplyScalar(factor);
});

/* Ù…Ø¶Ø®Ø©: Ù†ØºÙŠÙ‘Ø± Ø­Ø¬Ù… Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ ØªØ¯Ø±ÙŠØ¬ÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± */
document.getElementById('pumpSlider').addEventListener('input',(e)=>{
  const val = parseFloat(e.target.value);
  currentBoxScale = val;
  boxWire.scale.set(val, val, val);
  document.getElementById('volVal').innerText = Math.round(val*100) + '%';
  document.getElementById('boxSizeLabel').innerText = (BOX_HALF*2*val).toFixed(1);
});

/* Ø£Ø²Ø±Ø§Ø± Ø¥Ø¶Ø§ÙØ©/Ø­Ø°Ù Ø¬Ø²ÙŠØ¦Ø§Øª */
document.getElementById('addBtn').addEventListener('click',()=>{
  for (let k=0;k<20;k++){
    const spread = BOX_HALF*1.2*currentBoxScale;
    createParticle(THREE.MathUtils.randFloatSpread(spread),
                   THREE.MathUtils.randFloatSpread(spread),
                   THREE.MathUtils.randFloatSpread(spread),
                   THREE.MathUtils.randFloatSpread(1.2)*(temperature/300),
                   THREE.MathUtils.randFloatSpread(1.2)*(temperature/300),
                   THREE.MathUtils.randFloatSpread(1.2)*(temperature/300));
  }
  updateUICounts();
});
document.getElementById('removeBtn').addEventListener('click',()=>{
  for (let k=0;k<20;k++){
    const p = particles.pop();
    if (!p) break;
    particleGroup.remove(p);
  }
  updateUICounts();
});

/* ØªØ´ØºÙŠÙ„ / Ø¥ÙŠÙ‚Ø§Ù / Ø¥Ø¹Ø§Ø¯Ø© */
document.getElementById('startBtn').addEventListener('click',()=>{ 
  running=true; 
  document.querySelector('#startBtn .status-dot').style.background = '#2ecc71';
});
document.getElementById('pauseBtn').addEventListener('click',()=>{ 
  running=false; 
  document.querySelector('#startBtn .status-dot').style.background = '#ffa500';
});
document.getElementById('resetBtn').addEventListener('click',()=>{
  initParticles(180);
  collisionCount = 0; collisionsThisSecond = 0;
  temperature = 300;
  document.getElementById('tempSlider').value = temperature;
  document.getElementById('tempVal').innerText = temperature.toFixed(0);
  boxWire.scale.set(1,1,1); currentBoxScale = 1;
  document.getElementById('pumpSlider').value = 1;
  document.getElementById('volVal').innerText = '100%';
  document.querySelector('#startBtn .status-dot').style.background = '#2ecc71';
});

/* ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª */
function updateUICounts(){
  document.getElementById('countParticles').innerText = particles.length;
}

/* Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ù†Ø§ÙØ°Ø© */
window.addEventListener('resize', ()=>{
  const container = document.querySelector('.simulation-section');
  camera.aspect = container.clientWidth / container.clientHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(container.clientWidth, container.clientHeight);
});

/* ØªÙ‡ÙŠØ¦Ø© Ø£ÙˆÙ„ÙŠØ© ÙˆØªØ´ØºÙŠÙ„ */
initParticles(180);
updateUICounts();
animate(performance.now());

/* Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ù…ÙØ§ØªÙŠØ­ */
window.addEventListener('keydown', (e)=>{
  if (e.key === ' '){ running = !running; }
  if (e.key === 'ArrowUp'){ document.getElementById('heatBtn').click(); }
  if (e.key === 'ArrowDown'){ document.getElementById('coolBtn').click(); }
});

/* Ù…Ø¶Ø®Ø© Ø§Ù„ØºØ§Ø² */
let pumpActive = false;
let pumpDirection = 0; // 0: Ù…ØªÙˆÙ‚ÙØ©, 1: Ù„Ù„Ø¯Ø§Ø®Ù„, -1: Ù„Ù„Ø®Ø§Ø±Ø¬

document.getElementById('pumpInBtn').addEventListener('click', () => {
  pumpActive = true;
  pumpDirection = 1;
  document.getElementById('pumpStatus').textContent = 'Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¶Ø®Ø©: Ø¶Ø® Ù„Ù„Ø¯Ø§Ø®Ù„';
  document.getElementById('piston').style.top = '20px';
});

document.getElementById('pumpOutBtn').addEventListener('click', () => {
  pumpActive = true;
  pumpDirection = -1;
  document.getElementById('pumpStatus').textContent = 'Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¶Ø®Ø©: Ø¶Ø® Ù„Ù„Ø®Ø§Ø±Ø¬';
  document.getElementById('piston').style.top = '60px';
});

// Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ Ø§Ù„Ù…Ø¶Ø®Ø©
setInterval(() => {
  if (pumpActive) {
    if (pumpDirection === 1) {
      // Ø¶Ø® Ù„Ù„Ø¯Ø§Ø®Ù„ - ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø­Ø¬Ù…
      currentBoxScale = Math.max(0.3, currentBoxScale - 0.01);
    } else if (pumpDirection === -1) {
      // Ø¶Ø® Ù„Ù„Ø®Ø§Ø±Ø¬ - Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø­Ø¬Ù…
      currentBoxScale = Math.min(1.5, currentBoxScale + 0.01);
    }
    
    boxWire.scale.set(currentBoxScale, currentBoxScale, currentBoxScale);
    document.getElementById('pumpSlider').value = currentBoxScale;
    document.getElementById('volVal').textContent = Math.round(currentBoxScale * 100) + '%';
    document.getElementById('boxSizeLabel').textContent = (BOX_HALF * 2 * currentBoxScale).toFixed(1);
    
    // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¶Ø®Ø© Ø¨Ø¹Ø¯ ÙØªØ±Ø©
    setTimeout(() => {
      pumpActive = false;
      document.getElementById('pumpStatus').textContent = 'Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¶Ø®Ø©: Ù…ØªÙˆÙ‚ÙØ©';
      document.getElementById('piston').style.top = '40px';
    }, 1000);
  }
}, 50);

/* ØªØºÙŠÙŠØ± Ù†ÙˆØ¹ Ø§Ù„ØºØ§Ø² */
document.querySelectorAll('.gas-type-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.gas-type-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    
    currentGasType = btn.dataset.gas;
    const gas = gasProperties[currentGasType];
    
    // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØºØ§Ø²
    document.getElementById('molarMass').textContent = gas.molarMass.toFixed(2) + ' g/mol';
    document.getElementById('specificHeat').textContent = gas.specificHeat.toFixed(3) + ' J/gÂ·K';
    document.getElementById('viscosity').textContent = gas.viscosity.toFixed(1) + ' Î¼PaÂ·s';
    document.getElementById('boilingPoint').textContent = gas.boilingPoint.toFixed(1) + 'Â°C';
    document.getElementById('molarMassLabel').textContent = gas.molarMass.toFixed(2);
    
    // ØªØ­Ø¯ÙŠØ« Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª
    particles.forEach(p => {
      p.userData.originalColor = gas.color;
      updateParticleColor(p);
    });
  });
});

/* Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    
    tab.classList.add('active');
    document.getElementById(tab.dataset.tab + '-tab').classList.add('active');
  });
});

/* Ù†Ù…Ø· Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª */
document.querySelectorAll('[data-style]').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('[data-style]').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    
    const style = btn.dataset.style;
    let geometry;
    
    switch(style) {
      case 'spheres': geometry = sphereGeom; break;
      case 'cubes': geometry = cubeGeom; break;
      case 'dots': geometry = dotGeom; break;
    }
    
    particles.forEach(p => {
      p.geometry = geometry;
    });
  });
});

/* Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª */
document.querySelectorAll('[data-color]').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('[data-color]').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    
    // ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø¨Ø³Ø·Ø©ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø­Ø³Ø¨ Ø§Ù„Ø³Ø±Ø¹Ø© ÙÙ‚Ø·
    // ÙŠÙ…ÙƒÙ† ØªØ·ÙˆÙŠØ± Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ù„ÙŠØ´Ù…Ù„ Ø£Ù†Ø¸Ù…Ø© Ø£Ù„ÙˆØ§Ù† Ø£Ø®Ø±Ù‰
  });
});

/* Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª */
document.getElementById('trailsOn').addEventListener('click', () => {
  // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø§Ø±Ø§Øª Ù‡Ù†Ø§ ÙÙŠ Ù†Ø³Ø®Ø© Ù…Ø·ÙˆØ±Ø©
  alert('Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø§ØµÙŠØ© Ø³ØªØ¶Ø§Ù ÙÙŠ Ù†Ø³Ø®Ø© Ù‚Ø§Ø¯Ù…Ø© Ù…Ù† Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©');
});

document.getElementById('trailsOff').addEventListener('click', () => {
  document.querySelectorAll('#trailsOn, #trailsOff').forEach(b => b.classList.remove('active'));
  document.getElementById('trailsOff').classList.add('active');
});

/* Ø´Ø¯Ø© Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© */
document.getElementById('lightSlider').addEventListener('input', (e) => {
  const intensity = parseFloat(e.target.value);
  hemi.intensity = 0.7 * intensity;
  pLight.intensity = 1.1 * intensity;
});

/* Ù„Ù…Ø³Ø© Ù†Ù‡Ø§Ø¦ÙŠØ©: Ù…Ø¤Ø«Ø± Ø¨ØµØ±ÙŠ Ø¹Ù†Ø¯ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø­Ø±Ø§Ø±Ø© - Ù†Ø¬Ø¹Ù„ Ø§Ù„Ù…Ø§Ø¯Ø© ØªØªÙˆÙ‡Ø¬ */
(function heatVisualLoop(){
  requestAnimationFrame(heatVisualLoop);
  // Ø¥Ø°Ø§ Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø¹Ø§Ù„ÙŠØ© Ù†Ø¨Ø¯Ù‘Ù„ Ù„ÙˆÙ† Ù…Ø´ØªØ±
  const h = temperature;
  for (let p of particles){
    if (h > 500 && Math.random() < 0.003){
      p.material.emissive = new THREE.Color(0x3b1200);
      setTimeout(()=>{ if (p) p.material.emissive = new THREE.Color(0x000000); }, 500 + Math.random()*900);
    }
  }
})();

// Ø¥Ø¶Ø§ÙØ© Ø¹Ø¯Ø§Ø¯ Ù…Ø±ÙƒØ²ÙŠ ÙƒØ¨ÙŠØ±
const particleCountDisplay = document.createElement('div');
particleCountDisplay.className = 'particle-count';
particleCountDisplay.id = 'particleCountDisplay';
particleCountDisplay.textContent = '180';
container.appendChild(particleCountDisplay);

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ
setInterval(() => {
  document.getElementById('particleCountDisplay').textContent = particles.length;
}, 500);

</script>
</body>
</html>