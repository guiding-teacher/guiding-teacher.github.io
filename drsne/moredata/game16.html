<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ø¹Ù„Ù… Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ - Ø³ÙˆØ±Ø© Ø§Ù„ÙØ§ØªØ­Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #d4af37;
            --dark-blue: #1a3c61;
            --success-green: rgba(46, 204, 113, 0.4);
            --success-border: #27ae60;
            --highlight: rgba(212, 175, 55, 0.2);
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        header {
            background: var(--dark-blue);
            color: var(--gold);
            width: 100%;
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        header h1 { margin: 0; font-family: 'Amiri', serif; font-size: 2rem; }
        
        .buttons-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .header-btn {
            background: var(--gold);
            color: var(--dark-blue);
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
            font-family: 'Tajawal', sans-serif;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .header-btn:hover { background: #fff; }
        .header-btn.active { background: #e74c3c; color: white; }
        .header-btn.play-all { background: #27ae60; color: white; }
        .header-btn.play-all:hover { background: #2ecc71; }

        .quran-container {
            position: relative;
            max-width: 500px;
            width: 90%;
            margin: 20px auto;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            background: white;
            overflow: hidden;
        }

        .quran-container img {
            width: 100%;
            display: block;
            transition: filter 0.5s;
        }

        .verse-zone {
            position: absolute;
            left: 15%;
            width: 70%;
            cursor: pointer;
            transition: background 0.3s;
            border-radius: 5px;
            z-index: 10;
        }

        .verse-zone:hover {
            background: var(--highlight);
            border: 1px dashed var(--gold);
        }

        .verse-zone.active {
            background: rgba(26, 60, 97, 0.15);
            border: 2px solid var(--gold);
        }

        .verse-zone.completed {
            background: var(--success-green);
            border: 2px solid var(--success-border);
        }

        /* Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¢ÙŠØ§Øª */
        .v1 { top: 38%; height: 4%; width: 39%;left: 30%; } 
        .v2 { top: 43%; height: 4%;width: 39%;left: 30%; }
        .v3 { top: 48%; height: 4%; width: 22%;  left: 47%; }
        .v4 { top: 48%; height: 4%; width: 19%;  left: 25%; }
        .v5 { top: 52%; height: 4%; width: 39%;  left: 30%; }
        .v6 { top: 56%; height: 4%; width: 39%;  left: 30%; }
        .v7 { top: 61%; height: 13%; width: 39%;left: 30%; }

        .tafsir-panel {
            background: white;
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            padding: 20px;
            box-sizing: border-box;
            border-top: 5px solid var(--gold);
            box-shadow: 0 -5px 20px rgba(0,0,0,0.05);
            text-align: center;
            margin-bottom: 30px;
        }

        .tafsir-title {
            color: var(--dark-blue);
            font-family: 'Amiri', serif;
            font-size: 1.5rem;
            margin: 0 0 10px 0;
        }

        .tafsir-text {
            color: #555;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .player-controls {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .control-btn {
            background: var(--dark-blue);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .blur-mode img { filter: blur(10px); }
        
        .playing-indicator {
            color: var(--gold);
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
        }
        
        .loader {
            font-size: 0.8rem;
            color: #ccc;
            margin-top: 5px;
        }

    </style>
</head>
<body>

    <header>
        <h1>ğŸ“– Ø§Ù„Ù…Ø¹Ù„Ù… Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ: Ø§Ù„ÙØ§ØªØ­Ø©</h1>
        <div class="buttons-container">
            <button class="header-btn play-all" onclick="playFullSurah()">ğŸ”Š ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø© ÙƒØ§Ù…Ù„Ø©</button>
            <button class="header-btn mode-toggle" onclick="toggleMemoryMode()">ğŸ§  ÙˆØ¶Ø¹ Ø§Ù„ØªØ­ÙÙŠØ¸: Ù…Ø¹Ø·Ù„</button>
        </div>
    </header>

    <div class="quran-container" id="quranContainer">
        <!-- ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø§Ø± Ø§Ù„ØµÙˆØ±Ø© Ù‡Ù†Ø§ -->
        <img src="/drsne/images/ga16.jpg" alt="Ø³ÙˆØ±Ø© Ø§Ù„ÙØ§ØªØ­Ø©" id="quranImage" onerror="this.src='https://via.placeholder.com/500x700?text=ØªØ£ÙƒØ¯+Ù…Ù†+Ù…Ø³Ø§Ø±+Ø§Ù„ØµÙˆØ±Ø©'">
        
        <div class="verse-zone v1" id="zone1" onclick="userClickVerse(1)"></div>
        <div class="verse-zone v2" id="zone2" onclick="userClickVerse(2)"></div>
        <div class="verse-zone v3" id="zone3" onclick="userClickVerse(3)"></div>
        <div class="verse-zone v4" id="zone4" onclick="userClickVerse(4)"></div>
        <div class="verse-zone v5" id="zone5" onclick="userClickVerse(5)"></div>
        <div class="verse-zone v6" id="zone6" onclick="userClickVerse(6)"></div>
        <div class="verse-zone v7" id="zone7" onclick="userClickVerse(7)"></div>
    </div>

    <div class="tafsir-panel">
        <h3 class="tafsir-title" id="verseTitle">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¢ÙŠØ© Ù„Ù„Ø§Ø³ØªÙ…Ø§Ø¹</h3>
        <p class="tafsir-text" id="verseTafsir">Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø§Ù„ØªÙØ³ÙŠØ± Ø§Ù„Ù…ÙŠØ³Ø± Ù„Ù„Ø¢ÙŠØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©.</p>
        
        <div class="playing-indicator" id="indicator">ğŸ”Š Ø§Ù„Ù‚Ø§Ø±Ø¦ Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙØ§Ø³ÙŠ ÙŠÙ‚Ø±Ø£ Ø§Ù„Ø¢Ù†...</div>
        
        <div class="player-controls">
            <button class="control-btn" onclick="stopButtonAction()">â¹ï¸</button>
        </div>
    </div>

    <script>
        const surahData = {
            1: { title: "Ø§Ù„Ø¢ÙŠØ© 1", url: "https://everyayah.com/data/Alafasy_128kbps/001001.mp3", tafsir: "Ø£Ø¨Ø¯Ø£ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ØŒ Ù…Ø³ØªØ¹ÙŠÙ†Ø§Ù‹ Ø¨Ù‡ØŒ (Ø§Ù„Ù„Ù‡) Ù‡Ùˆ Ø§Ù„Ù…Ø£Ù„ÙˆÙ‡ Ø§Ù„Ù…Ø¹Ø¨ÙˆØ¯ØŒ (Ø§Ù„Ø±Ø­Ù…Ù†) Ø§Ù„Ø°ÙŠ ÙˆØ³Ø¹Øª Ø±Ø­Ù…ØªÙ‡ ÙƒÙ„ Ø´ÙŠØ¡ØŒ (Ø§Ù„Ø±Ø­ÙŠÙ…) Ø¨Ø§Ù„Ù…Ø¤Ù…Ù†ÙŠÙ†." },
            2: { title: "Ø§Ù„Ø¢ÙŠØ© 2", url: "https://everyayah.com/data/Alafasy_128kbps/001002.mp3", tafsir: "Ø§Ù„Ø«Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ù„Ù‡ Ø¨ØµÙØ§ØªÙ‡ Ø§Ù„ØªÙŠ ÙƒÙ„Ù‡Ø§ Ø£ÙˆØµØ§Ù ÙƒÙ…Ø§Ù„ØŒ ÙˆØ¨Ù†Ø¹Ù…Ù‡ Ø§Ù„Ø¸Ø§Ù‡Ø±Ø© ÙˆØ§Ù„Ø¨Ø§Ø·Ù†Ø©." },
            3: { title: "Ø§Ù„Ø¢ÙŠØ© 3", url: "https://everyayah.com/data/Alafasy_128kbps/001003.mp3", tafsir: "Ø§Ù„Ø±Ø­Ù…Ù†: Ø§Ù„Ø°ÙŠ ÙˆØ³Ø¹Øª Ø±Ø­Ù…ØªÙ‡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ù„Ù‚ØŒ Ø§Ù„Ø±Ø­ÙŠÙ…: Ø¨Ø§Ù„Ù…Ø¤Ù…Ù†ÙŠÙ† Ø®Ø§ØµØ©." },
            4: { title: "Ø§Ù„Ø¢ÙŠØ© 4", url: "https://everyayah.com/data/Alafasy_128kbps/001004.mp3", tafsir: "Ø§Ù„Ù…Ø§Ù„Ùƒ Ù„ÙƒÙ„ Ø´ÙŠØ¡ ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø©ØŒ ÙŠÙˆÙ… ÙŠØ¬Ø§Ø²Ù‰ Ø§Ù„Ù†Ø§Ø³ Ø¨Ø£Ø¹Ù…Ø§Ù„Ù‡Ù…." },
            5: { title: "Ø§Ù„Ø¢ÙŠØ© 5", url: "https://everyayah.com/data/Alafasy_128kbps/001005.mp3", tafsir: "Ù†Ø®ØµÙƒ ÙˆØ­Ø¯Ùƒ Ø¨Ø§Ù„Ø¹Ø¨Ø§Ø¯Ø©ØŒ ÙˆÙ†Ø³ØªØ¹ÙŠÙ† Ø¨Ùƒ ÙˆØ­Ø¯Ùƒ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø£Ù…ÙˆØ±Ù†Ø§." },
            6: { title: "Ø§Ù„Ø¢ÙŠØ© 6", url: "https://everyayah.com/data/Alafasy_128kbps/001006.mp3", tafsir: "Ø¯Ù„Ù†Ø§ ÙˆØ£Ø±Ø´Ø¯Ù†Ø§ ÙˆÙˆÙÙ‚Ù†Ø§ Ø¥Ù„Ù‰ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªÙ‚ÙŠÙ…ØŒ ÙˆØ«Ø¨ØªÙ†Ø§ Ø¹Ù„ÙŠÙ‡." },
            7: { title: "Ø§Ù„Ø¢ÙŠØ© 7", url: "https://everyayah.com/data/Alafasy_128kbps/001007.mp3", tafsir: "Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø°ÙŠÙ† Ø£Ù†Ø¹Ù…Øª Ø¹Ù„ÙŠÙ‡Ù… Ù…Ù† Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†ØŒ ØºÙŠØ± Ø·Ø±ÙŠÙ‚ Ø§Ù„Ù…ØºØ¶ÙˆØ¨ Ø¹Ù„ÙŠÙ‡Ù… ÙˆÙ„Ø§ Ø§Ù„Ø¶Ø§Ù„ÙŠÙ†." }
        };

        const audioCache = {};
        let currentAudioObj = null;
        let isMemoryMode = false;
        let isAutoPlaying = false; 

        // 1. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø§Ù„Ø¶Ø¹ÙŠÙ
        function preloadAudio() {
            let loadedCount = 0;
            const total = Object.keys(surahData).length;
            const loaderMsg = document.getElementById('loaderMsg');

            for (let id in surahData) {
                const audio = new Audio();
                audio.src = surahData[id].url;
                audio.preload = 'auto'; 
                audioCache[id] = audio;

                audio.oncanplaythrough = () => {
                    loadedCount++;
                    if(loadedCount === total) {
                        loaderMsg.innerText = "âœ… Ø§Ù„Ù…Ù„ÙØ§Øª Ø¬Ø§Ù‡Ø²Ø© (Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ù†ØªØ±Ù†Øª Ø§Ù„Ø¶Ø¹ÙŠÙ)";
                        setTimeout(() => loaderMsg.style.display = 'none', 3000);
                    }
                };
            }
        }

        window.onload = preloadAudio;

        // 2. Ø¹Ù†Ø¯ Ø¶ØºØ· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø¢ÙŠØ©
        function userClickVerse(id) {
            isAutoPlaying = false; // Ù†ÙˆÙ‚Ù Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªØ¯Ø®Ù„
            playVerse(id);
        }

        // 3. Ø¯Ø§Ù„Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø© ÙƒØ§Ù…Ù„Ø©
        function playFullSurah() {
            // ØªÙ†Ø¸ÙŠÙ ÙƒÙ„ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù„Ø¨Ø¯Ø§ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
            document.querySelectorAll('.verse-zone').forEach(z => {
                z.classList.remove('active');
                z.classList.remove('completed');
            });
            
            isAutoPlaying = true; // ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
            playVerse(1); // Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø£ÙˆÙ„ Ø¢ÙŠØ©
        }

        // 4. Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¢ÙŠØ©
        function playVerse(id) {
            // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¯ÙˆÙ† Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Stop Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ø­ØªÙ‰ Ù„Ø§ Ù†Ù„ØºÙŠ AutoPlay
            if (currentAudioObj) {
                currentAudioObj.pause();
                currentAudioObj.currentTime = 0;
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© (Ø§Ù„Ø£Ù„ÙˆØ§Ù†)
            document.querySelectorAll('.verse-zone').forEach(z => z.classList.remove('active'));
            const currentZone = document.getElementById(`zone${id}`);
            currentZone.classList.remove('completed'); 
            currentZone.classList.add('active'); // Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµÙˆØµ
            const data = surahData[id];
            document.getElementById('verseTitle').innerText = data.title;
            document.getElementById('verseTafsir').innerText = data.tafsir;

            // Ø§Ù„ØªØ´ØºÙŠÙ„
            if (audioCache[id]) {
                currentAudioObj = audioCache[id];
                currentAudioObj.currentTime = 0;
                
                const playPromise = currentAudioObj.play();
                if (playPromise !== undefined) {
                    playPromise.then(_ => {
                        document.getElementById('indicator').style.display = 'block';
                    }).catch(error => console.log("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØµÙˆØª:", error));
                }

                // Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¢ÙŠØ©
                currentAudioObj.onended = () => {
                    // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù„ÙˆÙ† Ù„Ù„Ø£Ø®Ø¶Ø±
                    currentZone.classList.remove('active');
                    currentZone.classList.add('completed'); 

                    // Ù…Ù†Ø·Ù‚ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¢ÙŠØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
                    if (isAutoPlaying && id < 7) {
                        playVerse(id + 1); // Ø´ØºÙ„ Ø§Ù„Ø¢ÙŠØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
                    } else {
                        // Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø³ÙˆØ±Ø© Ø£Ùˆ Ø§Ù„ØªÙˆÙ‚Ù
                        if (id === 7) {
                            document.getElementById('indicator').style.display = 'none';
                            isAutoPlaying = false;
                        }
                    }
                };
            }

            // Ù…Ù†Ø·Ù‚ ÙˆØ¶Ø¹ Ø§Ù„ØªØ­ÙÙŠØ¸ (Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¢ÙŠØ© Ù…Ø¤Ù‚ØªØ§Ù‹)
            if(isMemoryMode) {
                const img = document.getElementById('quranImage');
                img.style.filter = "blur(0px)";
                setTimeout(() => {
                    if(isMemoryMode) img.style.filter = "blur(10px)";
                }, 4000);
            }
        }

        // 5. Ø²Ø± Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù (Ø§Ù„Ù…Ø±Ø¨Ø¹)
        function stopButtonAction() {
            if (currentAudioObj) {
                currentAudioObj.pause();
                currentAudioObj.currentTime = 0;
            }
            document.getElementById('indicator').style.display = 'none';
            isAutoPlaying = false; // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø´ÙŠØ· Ø§Ù„Ø°Ù‡Ø¨ÙŠ ÙÙ‚Ø·ØŒ ÙˆØ¥Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø£Ø®Ø¶Ø± (Ø§Ù„Ù…ÙƒØªÙ…Ù„)
            document.querySelectorAll('.verse-zone').forEach(z => z.classList.remove('active'));
        }

        // 6. Ø²Ø± ÙˆØ¶Ø¹ Ø§Ù„ØªØ­ÙÙŠØ¸
        function toggleMemoryMode() {
            const btn = document.querySelector('.mode-toggle');
            const img = document.getElementById('quranImage');
            
            isMemoryMode = !isMemoryMode;

            if (isMemoryMode) {
                btn.innerText = "ğŸ§  ÙˆØ¶Ø¹ Ø§Ù„ØªØ­ÙÙŠØ¸: Ù…ÙØ¹Ù„";
                btn.classList.add('active');
                img.style.filter = "blur(10px)";
                document.getElementById('verseTafsir').innerText = "Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ù…ÙƒØ§Ù† Ø§Ù„Ø¢ÙŠØ© Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø­ÙØ¸Ùƒ.";
            } else {
                btn.innerText = "ğŸ§  ÙˆØ¶Ø¹ Ø§Ù„ØªØ­ÙÙŠØ¸: Ù…Ø¹Ø·Ù„";
                btn.classList.remove('active');
                img.style.filter = "none";
                document.getElementById('verseTafsir').innerText = "Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¢ÙŠØ© Ù„Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªÙØ³ÙŠØ±.";
            }
        }
    </script>
</body>
</html>