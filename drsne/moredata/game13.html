<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø­ÙƒØ§ÙŠØ© Ø§Ù„Ù†Ù…Ù„Ø© ÙˆØ§Ù„Ø­Ù…Ø§Ù…Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');

        :root {
            --primary: #27ae60;
            --secondary: #e67e22;
            --accent: #2980b9;
            --bg: #f5f6fa;
        }

        body {
            margin: 0;
            font-family: 'Tajawal', sans-serif;
            background: var(--bg);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        header {
            background: white;
            width: 100%;
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        h1 { margin: 0; color: var(--primary); font-size: 1.5rem; }
        p.subtitle { margin: 5px 0 0; color: #7f8c8d; }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù‚ØµØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .story-container {
            position: relative;
            width: 95%;
            max-width: 800px;
            background: white;
            padding: 10px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            aspect-ratio: 3 / 4;
            overflow: hidden;
        }

        /* Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© */
        #base-image {
            width: 100%;
            height: 100%;
            object-fit: fill;
            display: block;
            border-radius: 15px;
            opacity: 0.8;
            transition: 0.5s;
        }

        /* Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© */
        .story-grid {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 5px;
            padding: 10px;
            box-sizing: border-box;
        }

        .interactive-zone {
            position: relative;
            border-radius: 15px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            overflow: hidden;
            background: rgba(255,255,255,0.05);
        }

        .interactive-zone:hover {
            background: rgba(255,255,255,0);
            border-color: var(--secondary);
            box-shadow: 0 0 20px rgba(230, 126, 34, 0.4) inset;
            transform: scale(1.02);
            z-index: 2;
        }

        .play-icon {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-size: 3rem;
            color: white;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
            transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: none;
        }

        .interactive-zone:hover .play-icon {
            transform: translate(-50%, -50%) scale(1);
        }

        .zone-badge {
            position: absolute;
            top: 10px; right: 10px;
            background: var(--primary);
            color: white;
            width: 30px; height: 30px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold;
            transform: scale(0);
            transition: 0.3s;
        }
        .zone-badge.done { transform: scale(1); }

        /* --- Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© (Modal) --- */
        .modal-overlay {
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(5px);
            z-index: 1000;
            display: none;
            justify-content: center; align-items: center;
            padding: 20px;
        }

        .story-card {
            background: white;
            width: 100%; max-width: 500px;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            animation: cardEnter 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            text-align: center;
            position: relative;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù‚Ø±Ø¨Ø© */
        .zoomed-view {
            width: 100%;
            height: 250px;
            background-image: url('/drsne/images/ga13.jpg'); /* ØªÙ… Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø± */
            background-size: 200% 200%;
            background-repeat: no-repeat;
            border-bottom: 5px solid var(--secondary);
            position: relative;
        }
        
        /* Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙƒÙ„ Ù†Ø§ÙØ°Ø© */
        .scene-badge-icon {
            position: absolute;
            top: 20px; left: 50%;
            transform: translateX(-50%);
            font-size: 4rem;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3));
            animation: float 3s ease-in-out infinite;
            z-index: 2;
        }

        .speaker-btn {
            position: absolute;
            bottom: -25px; left: 50%;
            transform: translateX(-50%);
            width: 60px; height: 60px;
            background: var(--secondary);
            border-radius: 50%;
            border: 4px solid white;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            animation: pulse 2s infinite;
            z-index: 3;
        }
        .speaker-btn:hover { background: #d35400; }

        .content-area { padding: 40px 20px 20px; }

        .story-text {
            font-size: 1.2rem; color: #34495e;
            margin-bottom: 20px; line-height: 1.6;
            min-height: 60px;
        }

        .options-container { display: grid; gap: 10px; }

        .option-btn {
            background: #ecf0f1;
            border: 2px solid #bdc3c7;
            padding: 15px;
            border-radius: 15px;
            font-family: inherit;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.2s;
            color: #2c3e50;
            font-weight: bold;
        }

        .option-btn:hover { background: #d5dbdb; }
        .option-btn.correct { background: #2ecc71; border-color: #27ae60; color: white; }
        .option-btn.wrong { background: #e74c3c; border-color: #c0392b; color: white; animation: shake 0.4s; }

        /* Ø²Ø± Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø­Ø³Ù† */
        .close-btn {
            position: absolute; top: 15px; left: 15px;
            background: #e74c3c; color: white;
            border: 2px solid white;
            border-radius: 50%;
            width: 40px; height: 40px;
            cursor: pointer;
            font-size: 1.4rem;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            z-index: 10;
            transition: transform 0.2s;
            display: flex; align-items: center; justify-content: center;
        }
        .close-btn:hover { transform: scale(1.1); background: #c0392b; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-bar {
            width: 90%; max-width: 800px;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
        }
        .progress-fill {
            height: 100%; background: linear-gradient(90deg, var(--secondary), var(--primary));
            width: 0%; transition: 0.5s ease-out;
        }
        .progress-text {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.8rem; color: #333; font-weight: bold;
        }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„ÙÙˆØ² Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ */
        .victory-modal {
            position: fixed; inset: 0;
            background: rgba(39, 174, 96, 0.95);
            z-index: 2000;
            display: none;
            flex-direction: column;
            justify-content: center; align-items: center;
            animation: fadeIn 0.5s;
            text-align: center;
            color: white;
        }
        .victory-icon { font-size: 6rem; animation: bounce 1s infinite; }
        .victory-btn {
            margin-top: 20px;
            padding: 15px 40px;
            background: white; color: var(--primary);
            border: none; border-radius: 30px;
            font-size: 1.5rem; font-weight: bold;
            cursor: pointer; box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        @keyframes cardEnter { from { transform: scale(0.8) translateY(50px); opacity: 0; } to { transform: scale(1) translateY(0); opacity: 1; } }
        @keyframes pulse { 0% { transform: translateX(-50%) scale(1); } 50% { transform: translateX(-50%) scale(1.1); } 100% { transform: translateX(-50%) scale(1); } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        @keyframes float { 0%, 100% { transform: translateX(-50%) translateY(0); } 50% { transform: translateX(-50%) translateY(-10px); } }
        @keyframes bounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    </style>
</head>
<body>

    <header>
        <h1>ğŸ“– Ø­ÙƒØ§ÙŠØ© Ø§Ù„Ù†Ù…Ù„Ø© ÙˆØ§Ù„Ø­Ù…Ø§Ù…Ø©</h1>
        <p class="subtitle">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ± Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ³Ù…Ø§Ø¹ Ø§Ù„Ù‚ØµØ©</p>
    </header>

    <div class="progress-bar">
        <div class="progress-fill" id="progFill"></div>
        <span class="progress-text" id="progText">0 / 4 Ø£Ø­Ø¯Ø§Ø« Ù…ÙƒØªÙ…Ù„Ø©</span>
    </div>

    <div class="story-container">
        <img src="/drsne/images/ga13.jpg" id="base-image" alt="Ù‚ØµØ© Ø§Ù„Ù†Ù…Ù„Ø©">
        
        <div class="story-grid">
            <div class="interactive-zone" onclick="openStory(1)">
                <div class="play-icon">ğŸ§</div>
                <div class="zone-badge" id="badge-1">âœ“</div>
            </div>
            <div class="interactive-zone" onclick="openStory(2)">
                <div class="play-icon">ğŸ§</div>
                <div class="zone-badge" id="badge-2">âœ“</div>
            </div>
            <div class="interactive-zone" onclick="openStory(3)">
                <div class="play-icon">ğŸ§</div>
                <div class="zone-badge" id="badge-3">âœ“</div>
            </div>
            <div class="interactive-zone" onclick="openStory(4)">
                <div class="play-icon">ğŸ§</div>
                <div class="zone-badge" id="badge-4">âœ“</div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ -->
    <div class="modal-overlay" id="storyModal">
        <div class="story-card">
            <button class="close-btn" onclick="closeModal()" title="Ø¥ØºÙ„Ø§Ù‚">âœ•</button>
            
            <div class="zoomed-view" id="zoomedImg">
                <!-- Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø®Ø§ØµØ© -->
                <div class="scene-badge-icon" id="sceneIcon">ğŸœ</div>
                <button class="speaker-btn" onclick="replayAudio()" title="Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹">ğŸ”Š</button>
            </div>

            <div class="content-area">
                <div class="story-text" id="modalText">...</div>
                <h4 style="margin: 10px 0; color: var(--primary);">Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« ÙÙŠ Ø§Ù„ØµÙˆØ±Ø©ØŸ</h4>
                <div class="options-container" id="modalOptions"></div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ÙÙˆØ² Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->
    <div class="victory-modal" id="victoryModal">
        <div class="victory-icon">ğŸ†</div>
        <h1>Ø£Ø­Ø³Ù†Øª ÙŠØ§ Ø¨Ø·Ù„!</h1>
        <p style="font-size: 1.5rem; margin: 10px;">Ù„Ù‚Ø¯ Ø±ØªØ¨Øª Ø§Ù„Ù‚ØµØ© ÙƒØ§Ù…Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­</p>
        <button class="victory-btn" onclick="location.reload()">Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
    </div>

    <canvas id="confettiCanvas" style="position:fixed; top:0; left:0; pointer-events:none; z-index:3000;"></canvas>

    <script>
        // ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø®Ø§ØµÙŠØ© icon Ù„ÙƒÙ„ Ù…Ø´Ù‡Ø¯
        const storyData = {
            1: {
                id: 1,
                bgPos: '100% 0%',
                icon: 'ğŸœ', // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù†Ù…Ù„Ø©
                text: "ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ù†Ù…Ù„Ø© ØµØºÙŠØ±Ø© ØªÙ…Ø´ÙŠ Ù‚Ø±Ø¨ Ø§Ù„Ù†Ù‡Ø±ØŒ ÙˆÙØ¬Ø£Ø© Ø§Ù†Ø²Ù„Ù‚Øª ÙˆØ³Ù‚Ø·Øª ÙÙŠ Ø§Ù„Ù…Ø§Ø¡.",
                options: [
                    { txt: "Ø§Ù„Ù†Ù…Ù„Ø© ØªØ³Ø¨Ø­ ÙˆØªÙ„Ø¹Ø¨ ÙÙŠ Ø§Ù„Ù…Ø§Ø¡", correct: false },
                    { txt: "Ø§Ù„Ù†Ù…Ù„Ø© Ø³Ù‚Ø·Øª ÙÙŠ Ø§Ù„Ù…Ø§Ø¡ ÙˆØªØ·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©", correct: true },
                    { txt: "Ø§Ù„Ù†Ù…Ù„Ø© ØªØ´Ø±Ø¨ Ø§Ù„Ù…Ø§Ø¡ Ø¨Ù‡Ø¯ÙˆØ¡", correct: false }
                ]
            },
            2: {
                id: 2,
                bgPos: '0% 0%',
                icon: 'ğŸ•Šï¸', // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø­Ù…Ø§Ù…Ø©
                text: "Ø´Ø§Ù‡Ø¯Øª Ø§Ù„Ø­Ù…Ø§Ù…Ø© Ø§Ù„Ø·ÙŠØ¨Ø© Ø§Ù„Ù†Ù…Ù„Ø© ÙˆÙ‡ÙŠ ØªØºØ±Ù‚ØŒ ÙØ£Ø³Ø±Ø¹Øª ÙˆØ­Ù…Ù„Øª ØºØµÙ†Ø§Ù‹ ØµØºÙŠØ±Ø§Ù‹ Ø¨Ù…Ù†Ù‚Ø§Ø±Ù‡Ø§.",
                options: [
                    { txt: "Ø§Ù„Ø­Ù…Ø§Ù…Ø© ØªØ£ÙƒÙ„ Ø§Ù„ØºØµÙ†", correct: false },
                    { txt: "Ø§Ù„Ø­Ù…Ø§Ù…Ø© ØªØ·ÙŠØ± Ø¨Ø¹ÙŠØ¯Ø§Ù‹ Ø¹Ù† Ø§Ù„Ù†Ù‡Ø±", correct: false },
                    { txt: "Ø§Ù„Ø­Ù…Ø§Ù…Ø© ØªØ­Ù…Ù„ ØºØµÙ†Ø§Ù‹ Ù„ØªÙ†Ù‚Ø° Ø§Ù„Ù†Ù…Ù„Ø©", correct: true }
                ]
            },
            3: {
                id: 3,
                bgPos: '100% 100%',
                icon: 'ğŸŒ¿', // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØºØµÙ†
                text: "Ø±Ù…Øª Ø§Ù„Ø­Ù…Ø§Ù…Ø© Ø§Ù„ØºØµÙ† ÙÙŠ Ø§Ù„Ù…Ø§Ø¡ Ø¨Ø§Ù„Ù‚Ø±Ø¨ Ù…Ù† Ø§Ù„Ù†Ù…Ù„Ø© Ù„ÙƒÙŠ ØªØªÙ…Ø³Ùƒ Ø¨Ù‡.",
                options: [
                    { txt: "Ø±Ù…Øª Ø§Ù„Ø­Ù…Ø§Ù…Ø© Ø§Ù„ØºØµÙ† Ù„Ù„Ù†Ù…Ù„Ø©", correct: true },
                    { txt: "Ø§Ù„Ø­Ù…Ø§Ù…Ø© ØªØ¨Ù†ÙŠ Ø¹Ø´Ø§Ù‹ ÙÙŠ Ø§Ù„Ù…Ø§Ø¡", correct: false },
                    { txt: "Ø§Ù„Ù†Ù…Ù„Ø© ØªÙ‡Ø±Ø¨ Ù…Ù† Ø§Ù„ØºØµÙ†", correct: false }
                ]
            },
            4: {
                id: 4,
                bgPos: '0% 100%',
                icon: 'ğŸ¤', // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø´ÙƒØ±
                text: "ØµØ¹Ø¯Øª Ø§Ù„Ù†Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„ØºØµÙ† ÙˆÙˆØµÙ„Øª Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ§Ø¨Ø³Ø© Ø¨Ø³Ù„Ø§Ù…ØŒ ÙˆØ´ÙƒØ±Øª Ø§Ù„Ø­Ù…Ø§Ù…Ø© Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯ØªÙ‡Ø§.",
                options: [
                    { txt: "ØºØ±Ù‚Øª Ø§Ù„Ù†Ù…Ù„Ø© ÙÙŠ Ø§Ù„Ù…Ø§Ø¡", correct: false },
                    { txt: "ØªØ´Ø§Ø¬Ø±Øª Ø§Ù„Ù†Ù…Ù„Ø© Ù…Ø¹ Ø§Ù„Ø­Ù…Ø§Ù…Ø©", correct: false },
                    { txt: "Ù†Ø¬Øª Ø§Ù„Ù†Ù…Ù„Ø© ÙˆØ´ÙƒØ±Øª Ø§Ù„Ø­Ù…Ø§Ù…Ø©", correct: true }
                ]
            }
        };

        let currentScene = null;
        let completedScenes = new Set();

        function openStory(id) {
            currentScene = storyData[id];
            const modal = document.getElementById('storyModal');
            const zoomed = document.getElementById('zoomedImg');
            const text = document.getElementById('modalText');
            const optsDiv = document.getElementById('modalOptions');
            const iconDiv = document.getElementById('sceneIcon');

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù‚Ø±Ø¨Ø© ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©
            zoomed.style.backgroundPosition = currentScene.bgPos;
            iconDiv.innerText = currentScene.icon;

            text.innerText = "Ø§Ø³ØªÙ…Ø¹ Ø¬ÙŠØ¯Ø§Ù‹ Ù„Ù„Ù‚ØµØ©...";
            speak(currentScene.text);

            optsDiv.innerHTML = '';
            let shuffledOpts = [...currentScene.options].sort(() => Math.random() - 0.5);

            shuffledOpts.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt.txt;
                btn.onclick = () => checkAnswer(btn, opt.correct, id);
                optsDiv.appendChild(btn);
            });

            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('storyModal').style.display = 'none';
            window.speechSynthesis.cancel();
        }

        function checkAnswer(btn, isCorrect, id) {
            if(isCorrect) {
                btn.classList.add('correct');
                speak("Ø¥Ø¬Ø§Ø¨Ø© Ù…Ù…ØªØ§Ø²Ø©!");
                
                if(!completedScenes.has(id)) {
                    completedScenes.add(id);
                    document.getElementById(`badge-${id}`).classList.add('done');
                    updateProgress();
                }
                
                // Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ù‚Ù„ÙŠÙ„ Ù…Ù† Ø§Ù„ÙƒÙˆÙ†ÙÙŠØªÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
                fireConfetti(false); 
                
                setTimeout(() => closeModal(), 2000);
            } else {
                btn.classList.add('wrong');
                speak("Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");
            }
        }

        function updateProgress() {
            const count = completedScenes.size;
            const pct = (count / 4) * 100;
            document.getElementById('progFill').style.width = pct + '%';
            document.getElementById('progText').innerText = `${count} / 4 Ø£Ø­Ø¯Ø§Ø« Ù…ÙƒØªÙ…Ù„Ø©`;

            if(count === 4) {
                setTimeout(showVictory, 2500);
            }
        }

        function showVictory() {
            speak("Ø£Ø­Ø³Ù†Øª ÙŠØ§ Ø¨Ø·Ù„! Ù„Ù‚Ø¯ Ø±ØªØ¨Øª Ø§Ù„Ù‚ØµØ© ÙƒØ§Ù…Ù„Ø©.");
            document.getElementById('victoryModal').style.display = 'flex';
            fireConfetti(true); // ØªØ´ØºÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ÙÙˆØ² Ø§Ù„ÙƒØ¨ÙŠØ±
        }

        // =========================================================
        // Ø¯Ø§Ù„Ø© Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ù…ÙˆØ­Ø¯Ø© (ØªØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§Ù„Ù…ØªØµÙØ­)
        // =========================================================
        function speak(text) {
            // 1. Ø§Ù„ØªØ­Ù‚Ù‚: Ù‡Ù„ Ù†Ø­Ù† Ø¯Ø§Ø®Ù„ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯ØŸ
            if (typeof Android !== 'undefined' && Android.speakArabic) {
                // Ù†Ø¹Ù…: Ø§Ø³ØªØ®Ø¯Ù… Ù†Ø§Ø·Ù‚ Ø§Ù„Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ (Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© + ÙŠØ¹Ù…Ù„ Ø£ÙˆÙÙ„Ø§ÙŠÙ†)
                Android.speakArabic(text);
            } else {
                // Ù„Ø§: Ù†Ø­Ù† ÙÙŠ Ù…ØªØµÙØ­ ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø¹Ø§Ø¯ÙŠØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø§Ø·Ù‚ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
                if (window.speechSynthesis) {
                    speechSynthesis.cancel();
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'ar-SA';
                    utterance.rate = 0.9; // Ø³Ø±Ø¹Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©
                    utterance.pitch = 1.0; // Ù†Ø¨Ø±Ø© Ø§Ù„ØµÙˆØª
                    speechSynthesis.speak(utterance);
                }
            }
        }

        function replayAudio() {
            if(currentScene) speak(currentScene.text);
        }

        // --- Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒÙˆÙ†ÙÙŠØªÙŠ ---
        const canvas = document.getElementById('confettiCanvas');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.onresize = resizeCanvas;
        resizeCanvas();

        function fireConfetti(isBigVictory) {
            const amount = isBigVictory ? 300 : 50;
            for(let i=0; i<amount; i++) {
                particles.push({
                    x: canvas.width / 2,
                    y: isBigVictory ? canvas.height : canvas.height / 2,
                    vx: (Math.random() - 0.5) * (isBigVictory ? 30 : 20),
                    vy: (Math.random() - (isBigVictory ? 1 : 0.5)) * 25,
                    color: `hsl(${Math.random()*360}, 100%, 50%)`,
                    size: Math.random() * 10 + 5,
                    life: 150
                });
            }
            animateConfetti();
        }

        function animateConfetti() {
            if(particles.length === 0) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            for(let i=0; i<particles.length; i++) {
                let p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.5;
                p.life--;
                
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x, p.y, p.size, p.size);
                
                if(p.life <= 0 || p.y > canvas.height) {
                    particles.splice(i, 1);
                    i--;
                }
            }
            requestAnimationFrame(animateConfetti);
        }
    </script>
</body>
</html>